{% extends 'base.html' %}
{% load static %}

{% block title %}{{ project.title }} | Task Manager{% endblock %}

{% block page_title %}Project: {{ project.title }}{% endblock %}

{% block page_actions %}
<div class="action-buttons">
    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Add Task
    </a>
    <a href="{% url 'tasks:project_update' project.id %}" class="btn btn-outline">
        <i class="fas fa-edit"></i> Edit
    </a>
    <div class="dropdown">
        <button class="btn btn-outline dropdown-toggle">
            <i class="fas fa-ellipsis-v"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right">
            {% if project.is_archived %}
            <a href="#" class="dropdown-item toggle-archive-btn" data-project-id="{{ project.id }}" data-action="unarchive">
                <i class="fas fa-box-open"></i> Unarchive Project
            </a>
            {% else %}
            <a href="#" class="dropdown-item toggle-archive-btn" data-project-id="{{ project.id }}" data-action="archive">
                <i class="fas fa-archive"></i> Archive Project
            </a>
            {% endif %}
            <div class="dropdown-divider"></div>
            <a href="{% url 'tasks:project_delete' project.id %}" class="dropdown-item text-danger">
                <i class="fas fa-trash"></i> Delete Project
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview Section -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn-add">
                            <i class

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview Section -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn-add">
                            <i class="fas fa-plus">

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview Section -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn-add">
                            <i class="fas fa-

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview Section -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn-add">
                            

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview Section -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn-add">
                            <i class="fas fa

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                         <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }}
  <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>
{% extends 'base.html' %}
{% load static %}

{% block title %}{{ project.title }} | Task Manager{% endblock %}

{% block page_title %}Project: {{ project.title }}{% endblock %}

{% block page_actions %}
<div class="action-buttons">
    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Add Task
    </a>
    <a href="{% url 'tasks:project_update' project.id %}" class="btn btn-outline">
        <i class="fas fa-edit"></i> Edit
    </a>
    <div class="dropdown">
        <button class="btn btn-outline dropdown-toggle">
            <i class="fas fa-ellipsis-v"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right">
            {% if project.is_archived %}
            <a href="#" class="dropdown-item toggle-archive-btn" data-project-id="{{ project.id }}" data-action="unarchive">
                <i class="fas fa-box-open"></i> Unarchive Project
            </a>
            {% else %}
            <a href="#" class="dropdown-item toggle-archive-btn" data-project-id="{{ project.id }}" data-action="archive">
                <i class="fas fa-archive"></i> Archive Project
            </a>
            {% endif %}
            <div class="dropdown-divider"></div>
            <a href="{% url 'tasks:project_delete' project.id %}" class="dropdown-item text-danger">
                <i class="fas fa-trash"></i> Delete Project
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if in_progress_tasks %}
                            {% for task

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        {% if task.category %}
                                        <div class="task-category">
                                            <i class="fas fa-tag"></i>
                                            <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="task-footer">
                                        {% if task.assigned_to %}
                                        <div class="task-assigned">
                                            {% if task.assigned_to.profile_picture %}
                                            <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                            {% else %}
                                            <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                        
                                        <div class="task-comments-count">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ task.comments.count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-column">
                                <p>No tasks in this column</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- In Progress Column -->
                <div class="kanban-column" data-status="in_progress">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-in-progress"></i>
                            In Progress
                            <span class="task-count">{{ in_progress_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn-add">
                            <i class="fas fa-plus">

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
            <!-- Kanban Board View -->
            <div id="kanban-view" class="kanban-board" style="display: grid;">
                <!-- To Do Column -->
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h4 class="column-title">
                            <i class="fas fa-circle status-todo"></i>
                            To Do
                            <span class="task-count">{{ todo_tasks.count }}</span>
                        </h4>
                        <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                            <i class="fas fa-plus"></i>
                        </a>
                    </div>
                    <div class="column-body">
                        {% if todo_tasks %}
                            {% for task in todo_tasks %}
                            <div class="task-card draggable" data-task-id="{{ task.id }}">
                                <div class="card-body">
                                    <div class="task-header">
                                        <div class="task-priority priority-{{ task.priority }}"></div>
                                        <div class="task-actions dropdown">
                                            <button class="btn btn-sm btn-icon dropdown-toggle">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-eye"></i> View Details
                                                </a>
                                                <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                    <i class="fas fa-edit"></i> Edit Task
                                                </a>
                                                <div class="dropdown-divider"></div>
                                                <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                    <i class="fas fa-play"></i> Start Task
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="task-title">
                                        <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                    </h5>
                                    
                                    {% if task.description %}
                                    <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                    {% endif %}
                                    
                                    <div class="task-meta">
                                        {% if task.deadline %}
                                        <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                            <i class="fas fa-calendar-alt"></i>
                                            {{ task.deadline|date:"M d" }}
                                        </div>
                                        {% endif %}
                                        
                                        
            </div></search>
    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat

{% extends 'base.html' %}
{% load static %}

{% block title %}{{ project.title }} | Task Manager{% endblock %}

{% block page_title %}Project: {{ project.title }}{% endblock %}

{% block page_actions %}
<div class="action-buttons">
    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Add Task
    </a>
    <a href="{% url 'tasks:project_update' project.id %}" class="btn btn-outline">
        <i class="fas fa-edit"></i> Edit
    </a>
    <div class="dropdown">
        <button class="btn btn-outline dropdown-toggle">
            <i class="fas fa-ellipsis-v"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right">
            {% if project.is_archived %}
            <a href="#" class="dropdown-item toggle-archive-btn" data-project-id="{{ project.id }}" data-action="unarchive">
                <i class="fas fa-box-open"></i> Unarchive Project
            </a>
            {% else %}
            <a href="#" class="dropdown-item toggle-archive-btn" data-project-id="{{ project.id }}" data-action="archive">
                <i class="fas fa-archive"></i> Archive Project
            </a>
            {% endif %}
            <div class="dropdown-divider"></div>
            <a href="{% url 'tasks:project_delete' project.id %}" class="dropdown-item text-danger">
                <i class="fas fa-trash"></i> Delete Project
            </a>
        </div>
    </div>
</div>
{% endblock %}
{% block content %}
<div class="project-detail-container">
    <!-- Project Overview -->
    <div class="project-overview card mb-4">
        <div class="card-body">
            <div class="project-header mb-3">
                <h2 class="project-title">{{ project.title }}</h2>
                <div class="project-badges">
                    {% if project.is_archived %}
                    <span class="badge badge-dark">Archived</span>
                    {% endif %}
                    {% if project.is_overdue %}
                    <span class="badge badge-danger">Overdue</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="project-meta mb-4">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span>Start: {{ project.start_date }}</span>
                </div>
                {% if project.end_date %}
                <div class="meta-item {% if project.is_overdue %}text-danger{% endif %}">
                    <i class="fas fa-calendar-check"></i>
                    <span>Due: {{ project.end_date }}</span>
                    {% if project.is_overdue %}
                    <span class="badge badge-danger ml-2">Overdue</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Owner: {{ project.owner.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div class="project-description mb-4">
                <h4>Description</h4>
                {% if project.description %}
                <p>{{ project.description|linebreaks }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress mb-2">
                    <div class="progress-bar" style="width: {{ project.completion_percentage }}%">
                        {{ project.completion_percentage }}%
                    </div>
                </div>
                <div class="progress-stats">
                    <span>{{ project.completion_percentage }}% complete</span>
                    <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Statistics -->
    <div class="project-statistics card mb-4">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-chart-pie"></i> Project Statistics
            </h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Total Tasks</h4>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ project.task_count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>To Do</h4>
                        <div class="stat-icon todo-icon">
                            <i class="fas fa-list"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ todo_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>In Progress</h4>
                        <div class="stat-icon progress-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ in_progress_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Review</h4>
                        <div class="stat-icon review-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ review_tasks.count }}</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h4>Completed</h4>
                        <div class="stat-icon completed-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">{{ completed_tasks.count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Tasks -->
    <div class="project-tasks card">
        <div class="card-body">
            <div class="tasks-header d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">
                    <i class="fas fa-tasks"></i> Tasks
                </h3>
                <div class="tasks-actions">
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i> Add Task
                    </a>
                    <div class="view-toggle btn-group ml-2">
                        <button class="btn btn-sm btn-outline-secondary active" id="view-kanban">
                            <i class="fas fa-columns"></i> Kanban
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" id="view-list">
                            <i class="fas fa-list"></i> List
                        </button>
                    </div>
                </div>
            </div>
                        <div class="empty-column">
                            <p>No tasks in this column</p>
                        </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Completed Column -->
            <div class="kanban-column" data-status="completed">
                <div class="column-header">
                    <h4 class="column-title">
                        <i class="fas fa-circle status-completed"></i>
                        Completed
                        <span class="task-count">{{ completed_tasks.count }}</span>
                    </h4>
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=completed" class="btn btn-sm btn-add">
                        <i class="fas fa-plus"></i>
                    </a>
                </div>
                <div class="column-body">
                    {% if completed_tasks %}
                        {% for task in completed_tasks %}
                        <div class="task-card card draggable" data-task-id="{{ task.id }}">
                            <div class="card-body">
                                <div class="task-header">
                                    <div class="task-priority priority-{{ task.priority }}"></div>
                                    <div class="task-actions dropdown">
                                        <button class="btn btn-sm btn-icon dropdown-toggle">
                                            <i class="fas fa-ellipsis-h"></i>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-right">
                                            <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                <i class="fas fa-eye"></i> View Details
                                            </a>
                                            <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                <i class="fas fa-edit"></i> Edit Task
                                            </a>
                                            <div class="dropdown-divider"></div>
                                            <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="review">
                                                <i class="fas fa-undo"></i> Move Back to Review
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <h5 class="task-title">
                                    <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                </h5>
                                
                                {% if task.description %}
                                <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                {% endif %}
                                
                                <div class="task-meta">
                                    {% if task.completed_at %}
                                    <div class="task-completed">
                                        <i class="fas fa-check-circle"></i>
                                        Completed: {{ task.completed_at|date:"M d" }}
                                    </div>
                                    {% endif %}
                                    
                                    {% if task.category %}
                                    <div class="task-category">
                                        <i class="fas fa-tag"></i>
                                        <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="task-footer">
                                    {% if task.assigned_to %}
                                    <div class="task-assigned">
                                        {% if task.assigned_to.profile_picture %}
                                        <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                        {% else %}
                                        <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    <div class="task-comments-count">
                                        <i class="fas fa-comment"></i>
                                        <span>{{ task.comments.count }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-column">
                            <p>No tasks in this column</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        });
        
        // Make items draggable
        draggable.setAttribute('draggable', true
                <div class="view-toggle">
                    <button class="btn btn-sm btn-outline active" data-view="kanban"><i class="fas fa-columns"></i> Kanban</button>
                    <button class="btn btn-sm btn-outline" data-view="list"><i class="fas fa-list"></i> List</button>
                </div>
            </div>
        </div>
        
        <div class="kanban-board" id="kanban-board">
            <!-- To Do Column -->
            <div class="kanban-column" data-status="todo">
                <div class="column-header">
                    <h4 class="column-title">
                        <i class="fas fa-circle status-todo"></i>
                        To Do
                        <span class="task-count">{{ todo_tasks.count }}</span>
                    </h4>
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                        <i class="fas fa-plus"></i>
                    </a>
                </div>
                <div class="column-body">
                    {% if todo_tasks %}
                        {% for task in todo_tasks %}
                        <div class="task-card card draggable" data-task-id="{{ task.id }}">
                            <div class="card-body">
                                <div class="task-header">
                                    <div class="task-priority priority-{{ task.priority }}"></div>
                                    <div class="task-actions dropdown">
                                        <button class="btn btn-sm btn-icon dropdown-toggle">
                                            <i class="fas fa-ellipsis-h"></i>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-right">
                                            <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                <i class="fas fa-eye"></i> View Details
                                            </a>
                                            <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                <i class="fas fa-edit"></i> Edit Task
                                            </a>
                                            <div class="dropdown-divider"></div>
                                            <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                <i class="fas fa-play"></i> Start Task
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <h5 class="task-title">
                                    <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                </h5>
                                
                                {% if task.description %}
                                <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                {% endif %}
                                
                                <div class="task-meta">
                                    {% if task.deadline %}
                                    <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                        <i class="fas fa-calendar-alt"></i>
                                        {{ task.deadline|date:"M d" }}
                                    </div>
                                    {% endif %}
                                    
                                    {% if task.category %}
                                    <div class="task-category">
                                        <i class="fas fa-tag"></i>
                                        <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="task-footer">
                                    {% if task.assigned_to %}
                                    <div class="task-assigne
                                        {% if task.assigned_to.profile_picture %}
                                        <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                        {% else %}
                                        <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    <div class="task-comments-count">
                                        <i class="fas fa-comment"></i>
                                        <span>{{ task.comments.count }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-column">
                            <p>No tasks in this column</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
        justify-content: space-between;
        align-items: center;
        margin-top: var(--spacing-3);
    }
    
    .task-assigned {
        display: flex;
        gap: var(--spacing-1);
    }
    
    .task-completed {
        display: flex;
        align-items: center;
        gap: var(--spacing-1);
        color: var(--color-success);
        font-size: var(--font-size-xs);
    }
    
    .btn-icon {
        width: 28px;
        height: 28px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--border-radius-full);
        background-color: var(--color-background);
        color: var(--color-text-secondary);
        border: none;
    }
    
    .empty-column {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 150px;
        color: var(--color-text-secondary);
        text-align: center;
        padding: var(--spacing-4);
        background-color: var(--color-background);
        border-radius: var(--border-radius-md);
        margin: var(--spacing-2);
    }
    
    .empty-column p {
        margin-bottom: var(--spacing-3);
    }
    
    /* Task Item Animations */
    .task-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
    }
    
    .task-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-md);
        border-color: var(--color-primary);
    }
    
    /* Drag and Drop Effects */
    .task-card.is-dragging {
        transform: rotate(2deg) scale(1.02);
        box-shadow: var(--shadow-lg);
        z-index: 100;
        opacity: 0.9;
    }
    
    .column-body.drag-over {
        background-color: var(--color-primary-light);
        border-radius: var(--border-radius-md);
    }
    
    /* Tab Styling */
    .tasks-tabs {
        margin-top: var(--spacing-4);
    }
    
    .nav-tabs {
        display: flex;
        list-style: none;
        padding: 0;
        margin: 0 0 var(--spacing-4) 0;
        border-bottom: 1px solid var(--color-border);
    }
    
    .tab-item {
        padding: var(--spacing-3) var(--spacing-4);
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all var(--transition-fast);
        color: var(--color-text-secondary);
    }
    
    .tab-item:hover {
        color: var(--color-primary);
    }
    
    .tab-item.active {
        color: var(--color-primary);
        border-bottom-color: var(--color-primary);
        font-weight: var(--font-weight-medium);
    }
    
    .tab-content {
        display: none;
    }
    
    .tab-content.active {
        display: block;
    }
    
    /* Task List Styling */
    .tasks-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-3);
    }
    
    .task-item {
        display: flex;
        align-items: flex-start;
        padding: var(--spacing-3);
        background-color: var(--color-surface);
        border-radius: var(--border-radius-md);
        border: 1px solid var(--color-border);
        box-shadow: var
                <div class="progress-bar-container">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ project.completion_percentage }}%;"></div>
                    </div>
                </div>
                <div class="task-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ project.task_count }}</div>
                        <div class="stat-label">Total Tasks</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value status-todo">{{ todo_tasks.count }}</div>
                        <div class="stat-label">To Do</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value status-in-progress">{{ in_progress_tasks.count }}</div>
                        <div class="stat-label">In Progress</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value status-review">{{ review_tasks.count }}</div>
                        <div class="stat-label">In Review</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value status-completed">{{ completed_tasks.count }}</div>
                        <div class="stat-label">Completed</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    .project-badges {
        display: flex;
        gap: var(--spacing-2);
    }
    
    .project-description {
        margin-bottom: var(--spacing-4);
    }
    
    .project-meta-row {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        margin-bottom: var(--spacing-6);
        padding-bottom: var(--spacing-4);
        border-bottom: 1px solid var(--color-divider);
    }
    
    .project-dates, .project-owner {
        margin-bottom: var(--spacing-3);
    }
    
    .meta-item {
        display: flex;
        align-items: center;
        margin-bottom: var(--spacing-2);
    }
    
    .meta-label {
        width: 120px;
        font-weight: var(--font-weight-medium);
        color: var(--color-text-secondary);
        display: flex;
        align-items: center;
    }
    
    .meta-label i {
        margin-right: var(--spacing-2);
        color: var(--color-primary);
    }
    
    .owner-avatar {
        display: flex;
        align-items: center;
    }
    
    .owner-avatar img, .owner-avatar .avatar-initials {
        margin-right: var(--spacing-2);
    }
    
    .project-progress-section {
        padding-top: var(--spacing-4);
    }
    
    .progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-3);
    }
    
    .percentage {
        font-weight: var(--font-weight-bold);
        color: var(--color-primary);
    }
    
    .progress-bar-container {
        margin-bottom: var(--spacing-4);
    }
    
    .progress-bar {
        height: 8px;
        background-color: var(--color-background);
        border-radius: var(--border-radius-full);
        overflow: hidden;
    }
    
    .progress-fill {
        height: 100%;
        background-color: var(--color-primary);
        border-radius: var(--border-radius-full);
    }
    
    .task-stats {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: var(--spacing-4);
    }
    
    .stat-item {
        text-align: center;
    }
    
    .stat-value {
        font-size: var(--font-size-2xl);
        font-weight: var(--font-weight-bold);
        margin-bottom: var(--spacing-1);
    }
    
    .stat-label {
        font-size: var(--font-size-sm);
        color: var(--color-text-secondary);
    }
    
    .status-todo {
        color: var(--color-status-todo);
    }
    
    .status-in-progress {
        color: var(--color-status-in-progress);
    }
    
    .status-review {
        color: var(--color-status-review);
    }
    
    .status-completed {
        color: var(--color-status-completed);
    }
    
    /* Kanban Board Styling */
    .kanban-board-section {
        margin-top: var(--spacing-6);
    }
    
    .kanban-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-4);
    }
    
    .kanban-actions {
        display: flex;
        align-items: center;
        gap: var(--spacing-3);
    }
    
    .view-toggle {
        display: flex;
        border-radius: var(--border-radius-md);
        overflow: hidden;
        border: 1px solid var(--color-border);
    }
    
    .view-toggle button {
        padding: var(--spacing-1) var(--spacing-3);
        background-color: var(--color-surface);
        border: none;
        cursor: pointer;
    }
    
    .view-toggle button.active {
        background-color: var(--color-primary);
        color: white;
    }
    
    .kanban-board {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: var(--spacing-4);
        margin-top: var(--spacing-4);
    }
    
    @media (min-width: 1200px) {
        .kanban-board {
            grid-template-columns: repeat(4, 1fr);
        }
    }
    
    .kanban-column {
        background-color: var(--color-surface);
        border-radius: var(--border-radius-lg);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--color-border);
        display: flex;
        flex-direction: column;
        min-height: 300px;
        max-height: calc(100vh - 250px);
    }
    
    .column-header {
        padding: var(--spacing-3);
        border-bottom: 1px solid var(--color-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        background-color: var(--color-surface);
        border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        z-index: 1;
    }
    
    .column-title {
        margin: 0;
        font-size: var(--font-size-md);
        display: flex;
        align-items: center;
        gap: var(--spacing-2);
    }
    
    .task-count {
        font-size: var(--font-size-xs);
        background-color: var(--color-background);
        color: var(--color-text-secondary);
        border-radius: var(--border-radius-full);
        padding: 0 var(--spacing-2);
    }
    
    .btn-add {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--border-radius-full);
        color: var(--color-text-secondary);
        background-color: var(--color-background);
        border: none;
        cursor: pointer;
        padding: 0;
    }
    
    .btn-add:hover {
        background-color: var(--color-primary);
        color: white;
    }
    
    .column-body {
        padding: var(--spacing-2);
        flex: 1;
        overflow-y: auto;
    }
    
    .draggable {
        cursor: grab;
    }
    
    .draggable:active {
        cursor: grabbing;
    }
    
    .task-card {
        margin-bottom: var(--spacing-3);
        border-radius: var(--border-radius-md);
        background-color: var(--color-card);
        border: 1px solid var(--color-border);
        box-shadow: var(--shadow-sm);
        transition: transform var(--transition-normal), box-shadow var(--transition-normal);
    }
    
    .task-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }
    
    .task-card .card-body {
        padding: var(--spacing-3);
        position: relative;
    }
    
    .task-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: var(--spacing-2);
    }
    
    .task-priority {
        width: 4px;
        height: 36px;
        border-radius: var(--border-radius-full);
        margin-right: var(--spacing-2);
    }
    
    .priority-low {
        background-color: var(--color-priority-low);
    }
    
    .priority-medium {
        background-color: var(--color-priority-medium);
    }
    
    .priority-high {
        background-color: var(--color-priority-high);
    }
    
    .priority-urgent {
        background-color: var(--color-priority-urgent);
    }
    
    .task-title {
        font-size: var(--font-size-md);
        margin-bottom: var(--spacing-2);
    }
    
    .task-title a {
        color: var(--color-text);
        text-decoration: none;
    }
    
    .task-title a:hover {
        color: var(--color-primary);
    }
    
    .task-description {
        font-size: var(--font-size-sm);
        color: var(--color-text-secondary);
        margin-bottom: var(--spacing-3);
    }
    
    .task-meta {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-2);
        margin-bottom: var(--spacing-3);
        font-size: var(--font-size-xs);
    }
    
    .task-deadline {
        display: flex;
        align-items: center;
        gap: var(--spacing-1);
        color: var(--color-text-secondary);
    }
    
    .task-deadline.overdue {
        color: var(--color-danger);
    }
    
    .task-category {
        display: flex;
        align-items: center;
        gap: var(--spacing-1);
    }
    
    .category-label {
                <div class="project-meta">
                    <div class="meta-item">
                        <i class="fas fa-calendar"></i>
                        <span>Start: {{ project.start_date }}</span>
                    </div>
                    {% if project.end_date %}
                    <div class="meta-item {% if project.is_overdue %}overdue{% endif %}">
                        <i class="fas fa-calendar-check"></i>
                        <span>Due: {{ project.end_date }}</span>
                        {% if project.is_overdue %}
                        <span class="overdue-badge">Overdue</span>
                        {% endif %}
                    </div>
                    {% endif %}
                    <div class="meta-item">
                        <i class="fas fa-user"></i>
                        <span>Owner: {{ project.owner.username }}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-clock"></i>
                        <span>Created: {{ project.created_at|date:"M d, Y" }}</span>
                    </div>
                </div>
            </div>
            
            <div class="project-description">
                {% if project.description %}
                <h4>Description</h4>
                <p>{{ project.description }}</p>
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-progress">
                <h4>Progress</h4>
                <div class="progress-container">
                    <div class="progress">
                        <div class="progress-bar" style="width: {{ project.completion_percentage }}%"></div>
                    </div>
                    <div class="progress-stats">
                        <span>{{ project.completion_percentage }}% complete</span>
                        <span>{{ project.completed_task_count }}/{{ project.task_count }} tasks completed</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Project Statistics -->
<div class="project-statistics">
    <div class="section-title">
        <h2><i class="fas fa-chart-pie"></i> Project Statistics</h2>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-header">
                <h3>Total Tasks</h3>
                <div class="stat-icon">
                    <i class="fas fa-tasks"></i>
                </div>
            </div>
            <div class="stat-value">{{ project.task_count }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-header">
                <h3>To Do</h3>
                <div class="stat-icon todo-icon">
                    <i class="fas fa-list"></i>
                </div>
            </div>
            <div class="stat-value">{{ todo_tasks.count }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-header">
                <h3>In Progress</h3>
                <div class="stat-icon progress-icon">
                    <i class="fas fa-spinner"></i>
                </div>
            </div>
            <div class="stat-value">{{ in_progress_tasks.count }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-header">
                <h3>Completed</h3>
                <div class="stat-icon completed-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
            </div>
            <div class="stat-value">{{ completed_tasks.count }}</div>
        </div>
    </div>
</div>

<!-- Project Tasks -->
<div class="project-tasks">
    <div class="section-title">
        <h2><i class="fas fa-tasks"></i> Tasks</h2>
    </div>
    
    <!-- Tasks Tabs -->
    <div class="tasks-tabs">
        <ul class="nav-tabs">
            <li class="tab-item active" data-target="todo-tasks">
                <i class="fas fa-list"></i> To Do ({{ todo_tasks.count }})
            </li>
            <li class="tab-item" data-target="in-progress-tasks">
                <i class="fas fa-spinner"></i> In Progress ({{ in_progress_tasks.count }})
            </li>
            <li class="tab-item" data-target="review-tasks">
                <i class="fas fa-search"></i> Review ({{ review_tasks.count }})
            </li>
            <li class="tab-item" data-target="completed-tasks">
                <i class="fas fa-check-circle"></i> Completed ({{ completed_tasks.count }})
            </li>
        </ul>
        
        <!-- Todo Tasks -->
        <div id="todo-tasks" class="tab-content active">
            {% if todo_tasks %}
            <div class="tasks-list">
                {% for task in todo_tasks %}
                <div class="task-item">
                    <div class="task-status status-{{ task.status }}"></div>
                    <div class="task-content">
                        <div class="task-header">
                            <h4 class="task-title">
                                <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                            </h4>
                            <div class="task-priority priority-{{ task.priority }}">
                                {{ task.get_priority_display }}
                            </div>
                        </div>
                        <div class="task-description">
                            {{ task.description|truncatechars:100 }}
                        </div>
                        <div class="task-meta">
                            {% if task.deadline %}
                            <div class="meta-item {% if task.is_overdue %}overdue{% endif %}">
                                <i class="fas fa-clock"></i>
                                <span>Due: {{ task.deadline|date:"M d, Y" }}</span>
                            </div>
                            {% endif %}
                            {% if task.assigned_to %}
                            <div class="meta-item">
                                <i class="fas fa-user"></i>
                                <span>Assigned: {{ task.assigned_to.username }}</span>
                            </div>
                            {% endif %}
                            {% if task.category %}
                            <div class="meta-item">
                                <span class="category-color" style="background-color: {{ task.category.color }}"></span>
                                <span>{{ task.category.name }}</span>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="task-actions">
                        <a href="{% url 'tasks:task_detail' task.id %}" class="btn btn-sm btn-outline" title="View">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a href="{% url 'tasks:task_update' task.id %}" class="btn btn-sm btn-outline" title="Edit">
                            <i class="fas fa-edit"></i>
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <p>No tasks in this status</p>
                <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary">Add Task</a>
            </div>
            {% endif %}
        </div>
        
        <!-- In Progress Tasks -->
        <div id="in-progress-tasks" class="tab-content">
            {% if in_progress_tasks %}
            <div class="tasks-list">
                {% for task in in_progress_tasks %}
                <div class="task-item">
                    <div class="task-status status-{{ task.status }}"></div>
                    <div class="task-content">
                        <div class="task-header">
                            <h4 class="task-title">
                                <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                            </h4>
                            <div class="task-priority priority-{{ task.priority }}">
                                {{ task.get_priority_display }}
                            </div>
                        </div>
                        <div class="task-description">
                            {{ task.description|truncatechars:100 }}
                        </div>
                        <div class="task-meta">
                            {% if task.deadline %}
                            <div class="meta-item {% if task.is_overdue %}overdue{% endif %}">
                                <i class="fas fa-clock"></i>
                                <span>Due: {{ task.deadline|date:"M d, Y" }}</span>
                            </div>
                            {% endif %}
                            {% if task.assigned_to %}
                            <div class="meta-item">
                                <i class="fas fa-user"></i>
                                <span>Assigned: {{ task.assigned_to.username }}</span>
                            </div>
                            {% endif %}
                            {% if task.category %}
                            <div class="meta-item">
                                <span class="category-color" style="background-color: {{ task.category.color }}"></span>
                                <span>{{ task.category.name }}</span>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="task-actions">
                        <a href="{% url 'tasks:task_detail' task.id %}" class="btn btn-sm btn-outline" title="View">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a href="{% url 'tasks:task_update' task.id %}" class="btn btn-sm btn-outline" title="Edit">
                            <i class="fas fa-edit"></i>
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <p>No tasks in this status</p>
                <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary">Add Task</a>
            </div>
            {% endif %}
        </div>
        
        <!-- Review Tasks -->
        <div id="review-tasks" class="tab-content">
            {% if review_tasks %}
            <div class="tasks-list">
                {% for task in review_tasks %}
                <div class="task-item">
                    <div class="task-status status-{{ task.status }}"></div>
                    <div class="task-content">
                        <div class="task-header">
                            <h4 class="task-title">
                                <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                            </h4>
                            <div class="task-priority priority-{{ task.priority }}">
                                {{ task.get_priority_display }}
                            </div>
                        </div>
                        <div class="task-description">
                            {{ task.description|truncatechars:100 }}
                        </div>
                        <div class="task-meta">
                            {% if task.deadline %}
                            <div class="meta-item {% if task.is_overdue %}overdue{% endif %}">
                                <i class="fas fa-clock"></i>
                                <span>Due: {{ task.deadline|date:"M d, Y" }}</span>
                            </div>
                            {% endif %}
                            {% if task.assigned_to %}
                            <div class="meta-item">
                                <i class="fas fa-user"></i>
                                <span>Assigned: {{ task.assigned_to.username }}</span>
                            </div>
                            {% endif %}
                            {% if task.category %}
                            <div class="meta-item">
                                <span class="category-color" style="background-color: {{ task.category.color }}"></span>
                                <span>{{ task.category.name }}</span>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="task-actions">
                        <a href="{% url 'tasks:task_detail' task.id %}" class="btn btn-sm btn-outline" title="View">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a href="{% url 'tasks:task_update' task.id %}" class="btn btn-sm btn-outline" title="Edit">
                            <i class="fas fa-edit"></i>
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <p>No tasks in this status</p>
                <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary">Add Task</a>
            </div>
            {% endif %}
        </div>
        
        <!-- Completed Tasks -->
        <div id="completed-tasks" class="tab-content">
            {% if completed_tasks %}
            <div class="tasks-list">
                {% for task in completed_tasks %}
                <div class="task-item">
                    <div class="task-status status-{{ task.status }}"></div>
                    <div class="task-content">
                        <div class="task-header">
                            <h4 class="task-title">
                                <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                            </h4>
                            <div class="task-priority priority-{{ task.priority }}">
                                {{ task.get_priority_display }}
                            </div>
                        </div>
                        <div class="task-description">
                            {{ task.description|truncat

{% extends 'base.html' %}

{% block title %}{{ project.title }} | Task Manager{% endblock %}

{% block page_title %}Project: {{ project.title }}{% endblock %}

{% block page_actions %}
<a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-with-icon">
    <i class="fas fa-plus"></i>
    <span>Add Task</span>
</a>
<a href="{% url 'tasks:project_update' project.id %}" class="btn btn-outline btn-with-icon">
    <i class="fas fa-edit"></i>
    <span>Edit Project</span>
</a>
{% endblock %}

{% block content %}
<div class="project-detail-container">
    <!-- Project Overview Section -->
    <div class="project-overview card">
        <div class="card-body">
            <div class="project-header">
                <div class="project-info">
                    <h2 class="project-title">{{ project.title }}</h2>
                    <div class="project-badges">
                        {% if project.is_archived %}
                        <span class="badge badge-dark">Archived</span>
                        {% endif %}
                        {% if project.is_overdue %}
                        <span class="badge badge-danger">Overdue</span>
                        {% endif %}
                    </div>
                </div>
                <div class="project-actions dropdown">
                    <button class="btn btn-outline dropdown-toggle">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a href="{% url 'tasks:project_update' project.id %}" class="dropdown-item">
                            <i class="fas fa-edit"></i> Edit Project
                        </a>
                        {% if project.is_archived %}
                        <a href="#" class="dropdown-item toggle-archive-btn" data-project-id="{{ project.id }}" data-action="unarchive">
                            <i class="fas fa-box-open"></i> Unarchive Project
                        </a>
                        {% else %}
                        <a href="#" class="dropdown-item toggle-archive-btn" data-project-id="{{ project.id }}" data-action="archive">
                            <i class="fas fa-archive"></i> Archive Project
                        </a>
                        {% endif %}
                        <div class="dropdown-divider"></div>
                        <a href="{% url 'tasks:project_delete' project.id %}" class="dropdown-item text-danger">
                            <i class="fas fa-trash"></i> Delete Project
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="project-description">
                {% if project.description %}
                {{ project.description|linebreaks }}
                {% else %}
                <p class="text-muted">No description provided</p>
                {% endif %}
            </div>
            
            <div class="project-meta-row">
                <div class="project-dates">
                    <div class="meta-item">
                        <div class="meta-label"><i class="fas fa-calendar-plus"></i> Created On:</div>
                        <div class="meta-value">{{ project.created_at|date:"F j, Y" }}</div>
                    </div>
                    {% if project.start_date %}
                    <div class="meta-item">
                        <div class="meta-label"><i class="fas fa-hourglass-start"></i> Started On:</div>
                        <div class="meta-value">{{ project.start_date|date:"F j, Y" }}</div>
                    </div>
                    {% endif %}
                    {% if project.end_date %}
                    <div class="meta-item">
                        <div class="meta-label"><i class="fas fa-calendar-day"></i> Deadline:</div>
                        <div class="meta-value {% if project.is_overdue %}overdue{% endif %}">
                            {{ project.end_date|date:"F j, Y" }}
                            {% if project.is_overdue %}<span class="overdue-label">Overdue</span>{% endif %}
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                <div class="project-owner">
                    <div class="meta-label"><i class="fas fa-user"></i> Project Owner:</div>
                    <div class="meta-value owner-avatar">
                        {% if project.owner.profile_picture %}
                        <img src="{{ project.owner.profile_picture.url }}" alt="{{ project.owner.username }}" class="avatar-sm">
                        {% else %}
                        <div class="avatar-initials avatar-sm">{{ project.owner.username|first|upper }}</div>
                        {% endif %}
                        <span>{{ project.owner.username }}</span>
                    </div>
                </div>
            </div>
            
            <div class="project-progress-section">
                <div class="progress-header">
                    <h3 class="section-title">Project Progress</h3>
                    <div class="percentage">{{ project.completion_percentage }}% Complete</div>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ project.completion_percentage }}%;"></div>
                    </div>
                </div>
                <div class="task-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ project.task_count }}</div>
                        <div class="stat-label">Total Tasks</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value status-todo">{{ todo_tasks.count }}</div>
                        <div class="stat-label">To Do</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value status-in-progress">{{ in_progress_tasks.count }}</div>
                        <div class="stat-label">In Progress</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value status-review">{{ review_tasks.count }}</div>
                        <div class="stat-label">In Review</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value status-completed">{{ completed_tasks.count }}</div>
                        <div class="stat-label">Completed</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Kanban Board Section -->
    <div class="kanban-board-section">
        <div class="kanban-header">
            <h3 class="section-title">Tasks</h3>
            <div class="kanban-actions">
                <a href="{% url 'tasks:task_create' %}?project={{ project.id }}" class="btn btn-primary btn-sm btn-with-icon">
                    <i class="fas fa-plus"></i>
                    <span>Add Task</span>
                </a>
                <div class="view-toggle">
                    <button class="btn btn-sm btn-outline active" data-view="kanban"><i class="fas fa-columns"></i> Kanban</button>
                    <button class="btn btn-sm btn-outline" data-view="list"><i class="fas fa-list"></i> List</button>
                </div>
            </div>
        </div>
        
        <div class="kanban-board" id="kanban-board">
            <!-- To Do Column -->
            <div class="kanban-column" data-status="todo">
                <div class="column-header">
                    <h4 class="column-title">
                        <i class="fas fa-circle status-todo"></i>
                        To Do
                        <span class="task-count">{{ todo_tasks.count }}</span>
                    </h4>
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=todo" class="btn btn-sm btn-add">
                        <i class="fas fa-plus"></i>
                    </a>
                </div>
                <div class="column-body">
                    {% if todo_tasks %}
                        {% for task in todo_tasks %}
                        <div class="task-card card draggable" data-task-id="{{ task.id }}">
                            <div class="card-body">
                                <div class="task-header">
                                    <div class="task-priority priority-{{ task.priority }}"></div>
                                    <div class="task-actions dropdown">
                                        <button class="btn btn-sm btn-icon dropdown-toggle">
                                            <i class="fas fa-ellipsis-h"></i>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-right">
                                            <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                <i class="fas fa-eye"></i> View Details
                                            </a>
                                            <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                <i class="fas fa-edit"></i> Edit Task
                                            </a>
                                            <div class="dropdown-divider"></div>
                                            <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="in_progress">
                                                <i class="fas fa-play"></i> Start Task
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <h5 class="task-title">
                                    <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                </h5>
                                
                                {% if task.description %}
                                <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                {% endif %}
                                
                                <div class="task-meta">
                                    {% if task.deadline %}
                                    <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                        <i class="fas fa-calendar-alt"></i>
                                        {{ task.deadline|date:"M d" }}
                                    </div>
                                    {% endif %}
                                    
                                    {% if task.category %}
                                    <div class="task-category">
                                        <i class="fas fa-tag"></i>
                                        <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="task-footer">
                                    {% if task.assigned_to %}
                                    <div class="task-assigned">
                                        {% if task.assigned_to.profile_picture %}
                                        <img src="{{ task.assigned_to.profile_picture.url }}" alt="{{ task.assigned_to.username }}" class="avatar-xs">
                                        {% else %}
                                        <div class="avatar-initials avatar-xs">{{ task.assigned_to.username|first|upper }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    <div class="task-comments-count">
                                        <i class="fas fa-comment"></i>
                                        <span>{{ task.comments.count }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-column">
                            <p>No tasks in this column</p>
                        </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- In Progress Column -->
            <div class="kanban-column" data-status="in_progress">
                <div class="column-header">
                    <h4 class="column-title">
                        <i class="fas fa-circle status-in-progress"></i>
                        In Progress
                        <span class="task-count">{{ in_progress_tasks.count }}</span>
                    </h4>
                    <a href="{% url 'tasks:task_create' %}?project={{ project.id }}&status=in_progress" class="btn btn-sm btn-add">
                        <i class="fas fa-plus"></i>
                    </a>
                </div>
                <div class="column-body">
                    {% if in_progress_tasks %}
                        {% for task in in_progress_tasks %}
                        <div class="task-card card draggable" data-task-id="{{ task.id }}">
                            <div class="card-body">
                                <div class="task-header">
                                    <div class="task-priority priority-{{ task.priority }}"></div>
                                    <div class="task-actions dropdown">
                                        <button class="btn btn-sm btn-icon dropdown-toggle">
                                            <i class="fas fa-ellipsis-h"></i>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-right">
                                            <a href="{% url 'tasks:task_detail' task.id %}" class="dropdown-item">
                                                <i class="fas fa-eye"></i> View Details
                                            </a>
                                            <a href="{% url 'tasks:task_update' task.id %}" class="dropdown-item">
                                                <i class="fas fa-edit"></i> Edit Task
                                            </a>
                                            <div class="dropdown-divider"></div>
                                            <button class="dropdown-item task-status-btn" data-task-id="{{ task.id }}" data-status="review">
                                                <i class="fas fa-clipboard-check"></i> Submit for Review
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <h5 class="task-title">
                                    <a href="{% url 'tasks:task_detail' task.id %}">{{ task.title }}</a>
                                </h5>
                                
                                {% if task.description %}
                                <div class="task-description">{{ task.description|truncatechars:60 }}</div>
                                {% endif %}
                                
                                <div class="task-meta">
                                    {% if task.deadline %}
                                    <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">
                                        <i class="fas fa-calendar-alt"></i>
                                        {{ task.deadline|date:"M d" }}
                                    </div>
                                    {% endif %}
                                    
                                    {% if task.category %}
                                    <div class="task-category">
                                        <i class="fas fa-tag"></i>
                                        <span class="category-label" style="background-color: {{ task.category.color }};">{{ task.category.name }}</span>

